---
title: 智能通讯录使用指南
date: 2021-06-21 19:12:43
tags: VBA开发
top: 1
---

+ 项目：智能通讯录
+ 作者：冯振华
+ 单位：山东省平原县第一中学
+ 版本：V5.1
+ 版权：冯振华 @ CopyRight 2021/6/11-2021/6/26
+ 邮箱:fengzhenhua@outlook.com
+ 个人主页:[https://fengzhenhua-vip.github.io](https://fengzhenhua-vip.github.io)
+ 日志：增加JiaoShiFenZuLoad, JiaoShiZiXiLoad, IDAddressLoad ,判断是否存在对应的工作表，如果存在则加载并处理相关信息，不存在则忽略，避免了对应工作表不存在时的错误
+ 日志：由于改动幅度较大，直接由V3.6升级为V4.0,优化了代码结构，尽量调入内存提高效率，同时划分清楚打开工作薄时、和切换工作表时应当分别进行探测的项目

<!--more-->

+ 日志：增加关闭时自动清空查询页，并保存，阻止弹出保存对话框
+ 日志：不再设置“开发版”、“标准版”、“简化版”的版本常量信息，根据登录的查询源来判断版本，这样分发时不用再修改源码
+ 日志： V4.2加入查询校检功能含“身份证”、“手机号”、“短号”
+ 日志： V4.3修改撤消一次的实现方法，支持一张表内SeekRowMax次撤消
+ 日志： V4.4增加反撤消，即恢复功能，支持一张表内SeekRowMax次恢复，注意点清除后全部置零，不可再恢复，修改了Teacher为JiaoShi,Study为ZiXi ,原因为了不与考勤系统冲突
+ 日志： V4.7精简了关于分组名的定义及探测，系统自动探测源各组的组名，改以组名调入信息为以组索引号调入，如此可以自由改变Sheet名，增加了政治面貌的查询
+ 日志： V4.8增加LoadSeekSource对于配置文件的判断，以后则可以直接导入配置文件使用，同时修复SetOutColumnWidth中关于身份证、手机号、短号格式为文本格式的bug
+ 日志： V4.9修复按组查询时，输出同名的其他组人员bug
+ 日志： V5.1去除单元格的被选中的部分，同时去除了自动行高列宽和清空颜色两个模块，直接以代码写入需要的地方


----

# 安装使用

## 为什么需要这款通讯录

有人说我们都有手机，但是为什么还需要这么一款通讯录呢？因为你的手机不可能包含所有的同事;同时你知道同事叫什么名字，但不一定能将她的名字完全写对;对于面对一些安排工作时，每次都手工输入电话或身份证信息，不可能都毫无错误的输入，而本通讯录能帮您解决这些问题!


## 关于MSOffice办公软件的要求及设置

将此通讯录放置于个人习惯的目录即可，使用时双击打开即可查询。目前支持MSOffice2007及以上版本，本通讯录在MSOffice2016上开发完成，同时考虑到目前大家使用MSOffice2007人员较多，所以专门对MSOffice2007做了优化，在MSOffice2007上运行良好，速度较快，推荐同事们使用。关于MSOffice2007的安装文件大家可以自行下载或联系信息技术老师，安装时请一定`安装完整版本`，已经安装MSoffice2007的用户，如果宏没有启用，运行office2007安装程序，选择`添加或删除功能`，将`office共享功能`中的`Visual Basic for Applications` 及`VBA项目的数字证书`勾选安装上即可。由于本身在MSOffice2016上开发完成，所以安装此版Office也可以获得良好体验。

对于使用`WPS`的用户，由于其对`VBA`支持及大数据支持不是很好，同时免费版也会弹出广告等原因，目前不推荐同事们使用。同时，我个人也安装`WPS`的`VBA`模块进行测试，发现并不能完美工作，所以想要实现智能查询及日常办公，请安装`MSOffice2007及以上版本`。`LibreOffice` 也支持Macro ,而且比MSOffice支持的还要多，未来可能我也提供LibreOffice版本的通讯录在校内发布，向开源免费办公看齐。

如果你按装了MSOffice2007及以上版本，双击通讯录文件后，会出现警告提示`安全警告 宏已被禁用。` 此安全警告后面有按钮`启用内容` ，请点击`启用内容`则本通讯录查询宏就可以自动运行了，各项查询工作就可以方便进行了。

# 版本说明 

在工作中为了更快、更准确的获得同事之间的通讯方式，我使用VBA开发了这款智能通讯录，此次一共准备了三个版本：`标准版` ，`简化版` 和`开发版`。

## 标准版

`标准版`通讯录收录了全校教师的身份证信息，电话信息可以自动解析身份证包含的有关信息并提供查询。这个版本只提供给`行政办公室`用于人事工作，为保护大家的信息所以不对外发布，但是由于人事工作不包括教师自习的查询，所以标准版中删除了关于`教师自习`的模块，属于专为学校行政办公室提供的版本。

### 查询项目

{% note success %}
姓名、性别、年龄、民族、籍贯、政貌、文化程度、职务、学科组、身份证号、手机号、短号、电子邮箱、查询日期、拼音匹配、生肖、星座
{% endnote %}

上述项目应当在通讯录`第2行`填写,至少包含`姓名` ，`手机号`，`短号`，`身份证号` 之一，可以自由组合排列，以获得目标文档。系统只要检测到填写其中之一，则自动查询信息并写入对应列。

## 简化版

`简化版` 提供`老师自习安排`和`电话信息`模块，不支持所有有关身份证信息的查询，此版本对`平原一中校内发布` ，希望同事们自己方便工作，不要流传到外界，因个人原因导致流传到外界并造成不良影响的，由`个人承担法律责任`,与本作者无关。此版提供查询项目为

{% note success %}
姓名、职务、学科组、手机号、短号、电子邮箱、查询日期、拼音匹配
{% endnote %}

上述项目均在制作系统时锁定，不允许自由调整，仅提供基本查询，系统只要检测到填写其中之一，则自动查询信息并写入对应列。

## 开发版

此版本包含全部查询功能，仅用于个人工作及后期维护使用，不对作者以外的所有人开放。

# 查询说明

## 单个查询

在对应列下方输入对应的信息，则其他信息立刻自动查出。支持输入`姓名` ， `手机号` ，`短号` 中的任意一个，即可显示出所有其他信息。同时，标准版还支持`身份证号`输入，只要输入身份证号，立刻显示此号对应的人员的待查项目信息（对应项目标准版可以自由设置）。

## 按组查询

在`姓名列`输入学科组(比如`物理组`)，则系统自动查询本组人员，并全部列出。目前支持的`按组查询项`分别为：

{% note success %}
语文组、数学组、英语组、物理组、化学组、生物组、政治组、历史组、地理组、信息组、音乐组、体育组、美术组、督导室、初中部、行政办公室、政教处、教导处、实验室、水电办公室、教科所、前后勤、高一班主任、高二班主任、高三班主任、艺术部班主任、实验部班主任、复习部班主任
{% endnote %}

## 批量查询

在`姓名`、`手机号`、`短号`中的任何一列，粘贴对应的`姓名`、`手机号`、`短号`数据，然后点击`批量查询`,则所有人员将依次自动查询并列出。若之前有过查询，这三者如果不全，则系统先处理姓名、再手机号、最后处理短号。

## 姓名更正

本通讯录姓名严格按照身份证姓名进行了校对，如果输入错误的汉字，则系统自动纠正到身份证上的姓名。例如：在姓名列，输入`张大勇`，同系统自动更正为`张金明`,输入`刘军`，系统自动更正为`刘君`

## 导出

对于查询完的结果，点击导出按钮，则会自动生成EXCEL文件，并自动打开文件夹显示导出的文件。为了方便大家找到，此文件夹默认设置在桌面`查询结果` ，暂时不支持自定义导出文件夹位置。后期根据同事们反馈，适当增加相应功能。

## 清空和撤消

当查询条目过多时，可以点击`清空`按钮，恢复到初始状态，如果只是删除最后一条记录，则点击`撤消`按钮即可。

# 自由捐肋

开发一款软件需要莫大的精力，作为业余程序员，我希望能够为大家提供实用的工具，为了支持本软件的持续开发，欢迎自由捐助。超`5元`的捐助，将列在帮助文件致谢名单，感谢您的支持。



